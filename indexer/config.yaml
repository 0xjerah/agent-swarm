# yaml-language-server: $schema=./node_modules/envio/evm.schema.json
name: agentswarm-indexer
networks:
- id: 11155111  # Sepolia testnet
  start_block: 7500000  # Start from earlier block to catch all events
  contracts:
  # MasterAgent - Handles delegations and permissions
  - name: MasterAgent
    address:
    - 0x1fd734c9c78e9c34238c2b5f4E936368727326f6
    handler: src/EventHandlers.ts
    events:
    - event: PermissionDelegated(address indexed user, address indexed agent, uint256 dailyLimit, uint256 expiry)
      field_selection:
        transaction_fields:
          - hash
    - event: PermissionRevoked(address indexed user, address indexed agent)
      field_selection:
        transaction_fields:
          - hash
    - event: AgentRegistered(address indexed agent, string name)
    - event: TransferExecuted(address indexed user, address indexed agent, address indexed token, uint256 amount, address recipient)

  # DCAAgent - Handles DCA schedules
  - name: DCAAgent
    address:
    - 0xA86e7b31fA6a77186F09F36C06b2E7c5D3132795
    handler: src/EventHandlers.ts
    events:
    - event: DCAScheduleCreated(address indexed user, uint256 indexed scheduleId, uint256 amountPerPurchase, uint256 intervalSeconds, uint24 poolFee)
      field_selection:
        transaction_fields:
          - hash
    - event: DCAExecuted(address indexed user, uint256 indexed scheduleId, uint256 amountSpent, uint256 amountReceived)
      field_selection:
        transaction_fields:
          - hash
    - event: DCAScheduleCancelled(address indexed user, uint256 indexed scheduleId)
      field_selection:
        transaction_fields:
          - hash

  # YieldAgentAave - Handles Aave V3 yield strategies
  - name: YieldAgentAave
    address:
    - 0xb95adacB74E981bcfB1e97B4d277E51A95753C8F
    handler: src/EventHandlers.ts
    events:
    - event: YieldStrategyCreated(address indexed user, uint256 indexed strategyId, uint256 amount)
      field_selection:
        transaction_fields:
          - hash
    - event: DepositExecuted(address indexed user, uint256 indexed strategyId, uint256 amount, uint256 sharesReceived)
      field_selection:
        transaction_fields:
          - hash
    - event: WithdrawalExecuted(address indexed user, uint256 indexed strategyId, uint256 shares, uint256 amountReceived)
      field_selection:
        transaction_fields:
          - hash
    - event: RewardsClaimed(address indexed user, uint256 indexed strategyId, uint256 rewardAmount)
      field_selection:
        transaction_fields:
          - hash
    - event: StrategyPaused(uint256 indexed strategyId)
    - event: StrategyUnpaused(uint256 indexed strategyId)

  # YieldAgentCompound - Handles Compound V3 yield strategies
  - name: YieldAgentCompound
    address:
    - 0x7cbD25A489917C3fAc92EFF1e37C3AE2afccbcf2
    handler: src/EventHandlers.ts
    events:
    - event: YieldStrategyCreated(address indexed user, uint256 indexed strategyId, uint256 amount)
      field_selection:
        transaction_fields:
          - hash
    - event: DepositExecuted(address indexed user, uint256 indexed strategyId, uint256 amount, uint256 sharesReceived)
      field_selection:
        transaction_fields:
          - hash
    - event: WithdrawalExecuted(address indexed user, uint256 indexed strategyId, uint256 shares, uint256 amountReceived)
      field_selection:
        transaction_fields:
          - hash

unordered_multichain_mode: false
preload_handlers: true
